"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var lodash_1 = require("lodash");
var request = require("request-promise");
var debug_1 = require("../debug");
var MerchantApi = (function () {
    function MerchantApi() {
    }
    MerchantApi.login = function (baseUrl, body) {
        var opts = lodash_1.extend(MerchantApi.opts, { baseUrl: baseUrl, body: body });
        debug_1.debug("MerchantApi", "merchant/login", opts);
        return request("merchant/login", opts);
    };
    MerchantApi.ticket = function (baseUrl, token, body) {
        var opts = lodash_1.extend(MerchantApi.opts, { baseUrl: baseUrl, body: body, headers: { "Bex-Connection": token.Token } });
        debug_1.debug("MerchantApi", "merchant/" + token.Path + "/ticket?type=" + body.Type, opts);
        return request("merchant/" + token.Path + "/ticket?type=" + body.Type, opts);
    };
    MerchantApi.result = function (baseUrl, token, ticketId) {
        var opts = lodash_1.extend(MerchantApi.opts, { baseUrl: baseUrl, headers: { "Bex-Connection": token.Token } });
        debug_1.debug("MerchantApi", "merchant/" + token.Path + "/ticket/" + ticketId + "/operate?name=result", opts);
        return request("merchant/" + token.Path + "/ticket/" + ticketId + "/operate?name=result", opts);
    };
    MerchantApi.commit = function (baseUrl, token, body) {
        var opts = lodash_1.extend(MerchantApi.opts, { baseUrl: baseUrl, headers: { "Bex-Connection": token.Token, "Bex-Nonce": body.Nonce } });
        debug_1.debug("MerchantApi", "merchant/" + token.Path + "/ticket/" + body.Id + "/operate?name=commit", opts);
        return request("merchant/" + token.Path + "/ticket/" + body.Id + "/operate?name=commit", opts);
    };
    return MerchantApi;
}());
MerchantApi.opts = {
    baseUrl: null,
    body: {},
    headers: {},
    json: true,
    method: "POST",
    timeout: 20000,
};
exports.MerchantApi = MerchantApi;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVyY2hhbnRBcGkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvbWVyY2hhbnQvbWVyY2hhbnRBcGkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFPQSxpQ0FBOEI7QUFFOUIseUNBQTJDO0FBQzNDLGtDQUErQjtBQVEvQjtJQUFBO0lBdUNBLENBQUM7SUF6QmlCLGlCQUFLLEdBQW5CLFVBQW9CLE9BQWUsRUFBRSxJQUEwQjtRQUMzRCxJQUFNLElBQUksR0FBZ0IsZUFBTSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsRUFBQyxPQUFPLFNBQUEsRUFBRSxJQUFJLE1BQUEsRUFBQyxDQUFDLENBQUM7UUFDcEUsYUFBSyxDQUFDLGFBQWEsRUFBRSxnQkFBZ0IsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUM3QyxNQUFNLENBQUMsT0FBTyxDQUFDLGdCQUFnQixFQUFFLElBQUksQ0FBQyxDQUFDO0lBQzNDLENBQUM7SUFFYSxrQkFBTSxHQUFwQixVQUFxQixPQUFlLEVBQUUsS0FBWSxFQUFFLElBQW1CO1FBQ25FLElBQU0sSUFBSSxHQUFnQixlQUFNLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxFQUFDLE9BQU8sU0FBQSxFQUFFLElBQUksTUFBQSxFQUFFLE9BQU8sRUFBRSxFQUFDLGdCQUFnQixFQUFFLEtBQUssQ0FBQyxLQUFLLEVBQUMsRUFBQyxDQUFDLENBQUM7UUFDOUcsYUFBSyxDQUFDLGFBQWEsRUFBRSxjQUFZLEtBQUssQ0FBQyxJQUFJLHFCQUFnQixJQUFJLENBQUMsSUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzlFLE1BQU0sQ0FBQyxPQUFPLENBQUMsY0FBWSxLQUFLLENBQUMsSUFBSSxxQkFBZ0IsSUFBSSxDQUFDLElBQU0sRUFBRSxJQUFJLENBQUMsQ0FBQztJQUM1RSxDQUFDO0lBRWEsa0JBQU0sR0FBcEIsVUFBcUIsT0FBZSxFQUFFLEtBQVksRUFBRSxRQUFnQjtRQUNoRSxJQUFNLElBQUksR0FBZ0IsZUFBTSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsRUFBQyxPQUFPLFNBQUEsRUFBRSxPQUFPLEVBQUUsRUFBQyxnQkFBZ0IsRUFBRSxLQUFLLENBQUMsS0FBSyxFQUFDLEVBQUMsQ0FBQyxDQUFDO1FBQ3hHLGFBQUssQ0FBQyxhQUFhLEVBQUUsY0FBWSxLQUFLLENBQUMsSUFBSSxnQkFBVyxRQUFRLHlCQUFzQixFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzVGLE1BQU0sQ0FBQyxPQUFPLENBQUMsY0FBWSxLQUFLLENBQUMsSUFBSSxnQkFBVyxRQUFRLHlCQUFzQixFQUFFLElBQUksQ0FBQyxDQUFDO0lBRTFGLENBQUM7SUFFYSxrQkFBTSxHQUFwQixVQUFxQixPQUFlLEVBQUUsS0FBWSxFQUFFLElBQTJCO1FBQzNFLElBQU0sSUFBSSxHQUFnQixlQUFNLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxFQUFDLE9BQU8sU0FBQSxFQUFFLE9BQU8sRUFBRSxFQUFDLGdCQUFnQixFQUFFLEtBQUssQ0FBQyxLQUFLLEVBQUUsV0FBVyxFQUFFLElBQUksQ0FBQyxLQUFLLEVBQUMsRUFBQyxDQUFDLENBQUM7UUFDakksYUFBSyxDQUFDLGFBQWEsRUFBRSxjQUFZLEtBQUssQ0FBQyxJQUFJLGdCQUFXLElBQUksQ0FBQyxFQUFFLHlCQUFzQixFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzNGLE1BQU0sQ0FBQyxPQUFPLENBQUMsY0FBWSxLQUFLLENBQUMsSUFBSSxnQkFBVyxJQUFJLENBQUMsRUFBRSx5QkFBc0IsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUN6RixDQUFDO0lBRUwsa0JBQUM7QUFBRCxDQUFDLEFBdkNEO0FBQ2tCLGdCQUFJLEdBQWdCO0lBQzlCLE9BQU8sRUFBRSxJQUFJO0lBQ2IsSUFBSSxFQUFFLEVBQUU7SUFDUixPQUFPLEVBQUUsRUFJUjtJQUNELElBQUksRUFBRSxJQUFJO0lBQ1YsTUFBTSxFQUFFLE1BQU07SUFDZCxPQUFPLEVBQUUsS0FBSztDQUNqQixDQUFDO0FBWk8sa0NBQVciLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBhdXRob3IgIFTDvG1heSDDh2ViZXIgPHR1bWF5Y2ViZXJAZ21haWwuY29tPlxuICogQGxpbmsgICAgaHR0cHM6Ly9naXRodWIuY29tL2JyZW5kdHVtaS9ia21leHByZXNzXG4gKiBAbGljZW5zZSBodHRwOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvTUlUXG4gKiBAZGF0ZSAyNy4wNC4yMDE3XG4gKi9cblxuaW1wb3J0IHtleHRlbmR9IGZyb20gXCJsb2Rhc2hcIjtcbmltcG9ydCB7Q29yZU9wdGlvbnN9IGZyb20gXCJyZXF1ZXN0XCI7XG5pbXBvcnQgKiBhcyByZXF1ZXN0IGZyb20gXCJyZXF1ZXN0LXByb21pc2VcIjtcbmltcG9ydCB7ZGVidWd9IGZyb20gXCIuLi9kZWJ1Z1wiO1xuaW1wb3J0IHtNZXJjaGFudExvZ2luUmVxdWVzdH0gZnJvbSBcIi4vcmVxdWVzdC9tZXJjaGFudExvZ2luUmVxdWVzdFwiO1xuaW1wb3J0IHtUaWNrZXRSZXF1ZXN0fSBmcm9tIFwiLi9yZXF1ZXN0L3RpY2tldFJlcXVlc3RcIjtcbmltcG9ydCB7UmF3QmV4UmVzcG9uc2V9IGZyb20gXCIuL3Jlc3BvbnNlL2JleFJlc3BvbnNlXCI7XG5pbXBvcnQge01lcmNoYW50Tm9uY2VSZXNwb25zZX0gZnJvbSBcIi4vcmVzcG9uc2Uvbm9uY2UvbWVyY2hhbnROb25jZVJlc3BvbnNlXCI7XG5pbXBvcnQge1Bvc0RhdGF9IGZyb20gXCIuL3Jlc3BvbnNlL3BheW1lbnRSZXN1bHRSZXNwb25zZVwiO1xuaW1wb3J0IHtUb2tlbn0gZnJvbSBcIi4vdG9rZW5cIjtcblxuZXhwb3J0IGNsYXNzIE1lcmNoYW50QXBpIHtcbiAgICBwdWJsaWMgc3RhdGljIG9wdHM6IENvcmVPcHRpb25zID0ge1xuICAgICAgICBiYXNlVXJsOiBudWxsLFxuICAgICAgICBib2R5OiB7fSxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgLy8gXCJCZXgtQ29ubmVjdGlvblwiOiBUb2tlbi5Ub2tlbixcbiAgICAgICAgICAgIC8vIFwiQmV4LU5vbmNlXCI6IE1lcmNoYW50Tm9uY2VSZXNwb25zZS5Ob25jZSxcbiAgICAgICAgICAgIC8vIFwiQmV4LVRpY2tldFwiOiBcIlwiLFxuICAgICAgICB9LFxuICAgICAgICBqc29uOiB0cnVlLFxuICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICB0aW1lb3V0OiAyMDAwMCxcbiAgICB9O1xuXG4gICAgcHVibGljIHN0YXRpYyBsb2dpbihiYXNlVXJsOiBzdHJpbmcsIGJvZHk6IE1lcmNoYW50TG9naW5SZXF1ZXN0KTogUHJvbWlzZTxSYXdCZXhSZXNwb25zZTxUb2tlbj4gfCBFcnJvcj4ge1xuICAgICAgICBjb25zdCBvcHRzOiBDb3JlT3B0aW9ucyA9IGV4dGVuZChNZXJjaGFudEFwaS5vcHRzLCB7YmFzZVVybCwgYm9keX0pO1xuICAgICAgICBkZWJ1ZyhcIk1lcmNoYW50QXBpXCIsIFwibWVyY2hhbnQvbG9naW5cIiwgb3B0cyk7XG4gICAgICAgIHJldHVybiByZXF1ZXN0KFwibWVyY2hhbnQvbG9naW5cIiwgb3B0cyk7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyB0aWNrZXQoYmFzZVVybDogc3RyaW5nLCB0b2tlbjogVG9rZW4sIGJvZHk6IFRpY2tldFJlcXVlc3QpOiBQcm9taXNlPFJhd0JleFJlc3BvbnNlPFRva2VuPiB8IEVycm9yPiB7XG4gICAgICAgIGNvbnN0IG9wdHM6IENvcmVPcHRpb25zID0gZXh0ZW5kKE1lcmNoYW50QXBpLm9wdHMsIHtiYXNlVXJsLCBib2R5LCBoZWFkZXJzOiB7XCJCZXgtQ29ubmVjdGlvblwiOiB0b2tlbi5Ub2tlbn19KTtcbiAgICAgICAgZGVidWcoXCJNZXJjaGFudEFwaVwiLCBgbWVyY2hhbnQvJHt0b2tlbi5QYXRofS90aWNrZXQ/dHlwZT0ke2JvZHkuVHlwZX1gLCBvcHRzKTtcbiAgICAgICAgcmV0dXJuIHJlcXVlc3QoYG1lcmNoYW50LyR7dG9rZW4uUGF0aH0vdGlja2V0P3R5cGU9JHtib2R5LlR5cGV9YCwgb3B0cyk7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyByZXN1bHQoYmFzZVVybDogc3RyaW5nLCB0b2tlbjogVG9rZW4sIHRpY2tldElkOiBzdHJpbmcpOiBQcm9taXNlPFJhd0JleFJlc3BvbnNlPFBvc0RhdGE+IHwgRXJyb3I+IHtcbiAgICAgICAgY29uc3Qgb3B0czogQ29yZU9wdGlvbnMgPSBleHRlbmQoTWVyY2hhbnRBcGkub3B0cywge2Jhc2VVcmwsIGhlYWRlcnM6IHtcIkJleC1Db25uZWN0aW9uXCI6IHRva2VuLlRva2VufX0pO1xuICAgICAgICBkZWJ1ZyhcIk1lcmNoYW50QXBpXCIsIGBtZXJjaGFudC8ke3Rva2VuLlBhdGh9L3RpY2tldC8ke3RpY2tldElkfS9vcGVyYXRlP25hbWU9cmVzdWx0YCwgb3B0cyk7XG4gICAgICAgIHJldHVybiByZXF1ZXN0KGBtZXJjaGFudC8ke3Rva2VuLlBhdGh9L3RpY2tldC8ke3RpY2tldElkfS9vcGVyYXRlP25hbWU9cmVzdWx0YCwgb3B0cyk7XG5cbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGNvbW1pdChiYXNlVXJsOiBzdHJpbmcsIHRva2VuOiBUb2tlbiwgYm9keTogTWVyY2hhbnROb25jZVJlc3BvbnNlKTogUHJvbWlzZTxSYXdCZXhSZXNwb25zZTxQb3NEYXRhPiB8IEVycm9yPiB7XG4gICAgICAgIGNvbnN0IG9wdHM6IENvcmVPcHRpb25zID0gZXh0ZW5kKE1lcmNoYW50QXBpLm9wdHMsIHtiYXNlVXJsLCBoZWFkZXJzOiB7XCJCZXgtQ29ubmVjdGlvblwiOiB0b2tlbi5Ub2tlbiwgXCJCZXgtTm9uY2VcIjogYm9keS5Ob25jZX19KTtcbiAgICAgICAgZGVidWcoXCJNZXJjaGFudEFwaVwiLCBgbWVyY2hhbnQvJHt0b2tlbi5QYXRofS90aWNrZXQvJHtib2R5LklkfS9vcGVyYXRlP25hbWU9Y29tbWl0YCwgb3B0cyk7XG4gICAgICAgIHJldHVybiByZXF1ZXN0KGBtZXJjaGFudC8ke3Rva2VuLlBhdGh9L3RpY2tldC8ke2JvZHkuSWR9L29wZXJhdGU/bmFtZT1jb21taXRgLCBvcHRzKTtcbiAgICB9XG5cbn1cbiJdfQ==